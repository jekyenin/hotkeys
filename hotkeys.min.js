var Hotkeys=function(e){function t(e){var t=o(e);r(t)||m.push(t),hotkey=a(k,m),hotkey&&(e.preventDefault(),e.repeat||hotkey.func&&hotkey.func())}function n(e){var t=o(e);r(t)&&(pos=m.indexOf(t),m.splice(pos,1))}function r(e){return-1!==m.indexOf(e)?!0:!1}function o(e){var t=e.keyCode||e.which||e.charCode;return t=s(t)}function u(e){return l[e]?l[e]:String.fromCharCode(e)}function i(e){for(code in l)if(l[code]==e)return+code;return+e.charCodeAt(0)}function s(e){return i(u(e).toLowerCase())}function c(){m=[]}function a(e,t){var n,r={length:0};for(key in e)hotkey=e[key],n=hotkey.codes,f(t,n)&&hotkey.length>r.length&&(r=hotkey);return r.length>0?r:!1}function f(e,t){for(var n,r={},o=!0,u=0,i=e.length;i>u;u++)n=e[u],r[n]=!0;for(var u=0,i=t.length;i>u;u++)n=t[u],n in r||(o=!1);return o}function h(){document.addEventListener("keydown",t,!1),document.addEventListener("keyup",n,!1),window.addEventListener("blur",c,!1)}function d(){document.removeEventListener("keydown",t),document.removeEventListener("keyup",n),window.removeEventListener("blur",c)}function y(e){var t;for(key in e)t=e[key],g.add(key,t);h()}var g=this,m=[],k={},l={16:"shift",17:"ctrl",18:"alt",9:"tab",13:"enter",8:"backspace",32:"spacebar"},v=!1;this.add=function(e,t){if(arguments.length<2)throw TypeError("Failed to execute 'add' on 'Hotkeys': 2 arguments required, but "+arguments.length+" present.");if("string"!=typeof e)throw TypeError("The first argument must be a string");if("function"!=typeof t)throw TypeError("The second argument must be a function");e=e.toLowerCase();for(var n,r=e.split("+"),o=[],u=0,s=r.length;s>u;u++)n=r[u],o.push(i(n));var c={symbols:r,codes:o,length:o.length,func:t};return v&&(v=!1,h()),k[e]=c,g},this.remove=function(e){if(arguments.length<1)throw TypeError("Failed to execute 'remove' on 'Hotkeys': 1 argument required, but "+arguments.length+" present.");if(comb=e.toLowerCase(),void 0===k[comb])throw TypeError("Hotkey "+e+" is undefined");return delete k[comb],g},this.trigger=function(e){if(arguments.length<1)throw TypeError("Failed to execute 'trigger' on 'Hotkeys': 1 argument required, but "+arguments.length+" present.");if(comb=e.toLowerCase(),hotkey=k[comb],void 0===hotkey)throw TypeError("Hotkey "+e+" is undefined");return hotkey.func(),g},this.destroy=function(){return v=!0,d(),g},y(e)};